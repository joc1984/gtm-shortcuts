// This is a Javascript code created to run in Google Tag Manager as a variable that declares the gclid parameter, key for conversion attribution in Google Ads. The code was generated by AI attending the following prompt: extract the 'gclid' value from the url; if there is no match, look for the '_gcl_aw' 1p cookie; if there is no match, look for the 'GCL_AW_P' 3p cookie. If none matches, return 'undefined'.  

<script>
function() {
  var urlParams = new URLSearchParams(window.location.search);
  var gclid = urlParams.get('gclid');
  if (gclid) return gclid;

  function getCookieValue(name) {
    var cookies = document.cookie.split(';');
    for(var i=0; i<cookies.length; i++) {
      var cookie = cookies[i].trim();
      if (cookie.indexOf(name + '=') === 0) {
        return cookie.substring((name + '=').length);
      }
    }
    return null;
  }

  var cookieVal = getCookieValue('_gcl_aw');
  if (cookieVal) {
    var parts = cookieVal.split('.');
    if (parts.length >= 3) return parts[2];
  }

  cookieVal = getCookieValue('GCL_AW_P');
  if (cookieVal) {
    var parts = cookieVal.split('.');
    if (parts.length >= 3) return parts[2];
  }

  return undefined;
}

</script>
